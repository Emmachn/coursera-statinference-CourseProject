---
title: "Statistical Inference (statinference-011) Course Project"
author: "Esmit PÃ©rez"
date: "February 16, 2015"
output: pdf_document
---

```{r setoptions, echo = FALSE}
library(knitr)
# always echo.
opts_chunk$set(echo = TRUE, fig.width = 12, fig.height = 5)
```

#Part 1
##Overview

This is the report for the project for the statistical inference class. In it, I will use simulation to explore inference and do some simple inferential data analysis. The project consists of two parts:

1. A simulation exercise.
2. Basic inferential data analysis.

The format and formulas here included are based off the [outline of the project](https://class.coursera.org/statinference-011/human_grading/view/courses/973519/assessments/4/submissions).

##Simulations

The exponential distribution can be simulated in R with rexp(n, lambda) where lambda is the rate parameter. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda. Set lambda = 0.2 for all of the simulations. You will investigate the distribution of averages of 40 exponentials. Note that you will need to do a thousand simulations.

```{r prepare-data-frame}
# load libraries, setup variables
library(ggplot2)
lambda <- 0.2
mu <- 1/lambda
stdDev <- 1/lambda
numExponentials <- 40
numSimulations <- 1:1000

# we're dealing with random data, so always set seed to make it reproducible.
set.seed(909)

# obtains the mean of running rexp with 40 exponentials and given lambda
cfunc <- function(v) {mean(rexp(numExponentials, lambda))}

#  for each entry in array of size 1000, run the function
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(cfunc()))

dat <- data.frame(x = mns)

```


##Sample Mean versus Theoretical Mean

Theoretical mean is 1/lambda:
```{r theoretical-mean}
mu
```

The sample mean is:
```{r sample-mean}
mean(dat$x)
```

##Sample Variance versus Theoretical Variance

Theoretical variance is $\mu/\sqrt(n)$:
```{r theoretical-variance}
mu/sqrt(numExponentials)
```

The sample variance _S_ is:
```{r sample-variance}
var(dat$x)
```

##Distribution

The following graph shows how the mean values of 1000 simulations approximate the normal distribution (curve in red). For complete code and output see appendix, fig 1.1

```{r distribution-plot, echo=FALSE}
# plot and customize graph
g <- ggplot(dat, aes(x = x)) 
g <- g + geom_histogram(binwidth=.3, colour = "black", fill="white", 
        aes(y = ..density..)) 
g <- g + ggtitle("Means of 1000 simulations of rexp(40,0.02)") 
g <- g + xlab("Means") + ylab("Density")

g <- g + stat_function(fun = dnorm, arg=list( mean= mu, sd=sd(dat$x) ), 
        color="red", size=1)
g <- g + theme_bw()

g
```

#Part 2
Now in the second portion of the class, we're going to analyze the ToothGrowth data in the R datasets package. 

Load the ToothGrowth data and perform some basic exploratory data analyses.

```{r load-tooth-growth}
#load data set from R's provided datasets
data(ToothGrowth)
```


###Provide a basic summary of the data. 

_Note_: Please refer to appendix for a complete summary.

The following plot shows the growth length, per supplement at varying dosages (see R code and graph in appendix, fig 2.1):
```{r, tooth-growth-boxplot, echo=FALSE}
#plot and customize graph
g <- ggplot(ToothGrowth,aes(x = dose, y = len, color=supp))
g <- g + ggtitle("The Effect of Vitamin C on Tooth Growth in Guinea Pigs") 
g <- g + xlab("Dose level (in mg)") + ylab("Length")
g <- g + scale_color_discrete(name="Delivery Method (Supplement)",
                         breaks=c("OJ", "VC"),
                         labels=c("Orange Juice", "Ascorbic Acide"))
g <- g + geom_boxplot()
g <- g + facet_grid(. ~ dose , labeller = function(variable, value){ paste0(value," mg") })
g
```

###Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. (Only use the techniques from class, even if there's other approaches worth considering)

$H_{0}$ : Supplement _OJ (Orange Juice)_ leads to more growth.


###State your conclusions and the assumptions needed for your conclusions. 

Based on (Week 3 video) (https://class.coursera.org/statinference-011/lecture/243) we can perform a `t.test` to determine whether this is true, assuming variances are equal (see complete output in appendix, fig 2.2):

```{r ttestequal, echo=FALSE}
# Assume variances ARE equal
rbind(t.test(len ~ supp, paired=FALSE, var.equal=T, data=ToothGrowth)$conf,
      t.test(len ~ supp, paired=FALSE, var.equal=T, data=ToothGrowth)$conf
      )
```

Factors in `supp` show `OJ` comes first (see appendix, fig 2.3) and in both tests the result, is the same, column `1`, correspoding to `OJ` (_Orange Juice_) is below zero, meaning it does not lead to more length.


\newpage

#Appendix

## Part 1 - Supporting figures.

###Figure 1.1

```{r distribution-plot-app}
# plot and customize graph
g <- ggplot(dat, aes(x = x)) 
g <- g + geom_histogram(binwidth=.3, colour = "black", fill="white", 
        aes(y = ..density..)) 
g <- g + ggtitle("Means of 1000 simulations of rexp(40,0.02)") 
g <- g + xlab("Means") + ylab("Density")

g <- g + stat_function(fun = dnorm, arg=list( mean= mu, sd=sd(dat$x) ), 
        color="red", size=1)
g <- g + theme_bw()

g
```

## Part 2 - Supporting figures and exploratory analysis, ToothGrowth data.

##Description

"The Effect of Vitamin C on Tooth Growth in Guinea Pigs"

The response is the length of odontoblasts (teeth) in each of 10 guinea pigs at each of three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods (orange juice or ascorbic acid).

##Summary information for `ToothGrowth`:
```{r tooth-growth-summary}
str(ToothGrowth)
summary(ToothGrowth)
head(ToothGrowth)
```

##Example `coplot` as per `help(ToothGrowth)`:

```{r tooth-growth-coplot}
require(graphics)
coplot(len ~ dose | supp, data = ToothGrowth, panel = panel.smooth,
       xlab = "ToothGrowth data: length vs dose, given type of supplement")
```


### Figure 2.1
```{r, tooth-growth-boxplot-app}
#plot and customize graph
g <- ggplot(ToothGrowth,aes(x = dose, y = len, color=supp))
g <- g + ggtitle("The Effect of Vitamin C on Tooth Growth in Guinea Pigs") 
g <- g + xlab("Dose level (in mg)") + ylab("Length")
g <- g + scale_color_discrete(name="Delivery Method (Supplement)",
                         breaks=c("OJ", "VC"),
                         labels=c("Orange Juice", "Ascorbic Acide"))
g <- g + geom_boxplot()
g <- g + facet_grid(. ~ dose , labeller = function(variable, value){ paste0(value," mg") })
g
```

###Figure 2.2
```{r ttestequal-app}
# Assume variances ARE equal
rbind(t.test(len ~ supp, paired=FALSE, var.equal=T, data=ToothGrowth)$conf,
      t.test(len ~ supp, paired=FALSE, var.equal=T, data=ToothGrowth)$conf
      )
```

####Figure 2.3
```{r factorsofsupp-app}
factor(ToothGrowth$supp)
```